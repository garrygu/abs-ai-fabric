<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ABS AI Hub - Legal Workstation</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Nunito+Sans:wght@300;400;600;700&display=swap');
        
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #f8f9ff 0%, #e8f0ff 100%);
            min-height: 100vh;
            color: #2c3e50;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        .header {
            text-align: center;
            margin-bottom: 40px;
            color: #2c3e50;
        }
        .header h1 {
            font-size: 3rem;
            margin: 0;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        .header p {
            font-size: 1.2rem;
            opacity: 0.8;
            margin: 10px 0;
            color: #34495e;
        }

        /* Navigation Tabs */
        .nav-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 30px;
            justify-content: center;
        }
        .nav-tab {
            padding: 12px 24px;
            border: none;
            background: rgba(255, 255, 255, 0.7);
            color: #666;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 16px;
            font-weight: 500;
        }
        .nav-tab:hover {
            background: rgba(255, 255, 255, 0.9);
            color: #333;
        }
        .nav-tab.active {
            background: #667eea;
            color: white;
        }

        /* Tab Content */
        .tab-content {
            display: none;
        }
        .tab-content.active {
            display: block;
        }
        
        /* Apps Grid */
        .apps-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 20px;
            margin-top: 30px;
        }
        .app-card {
            background: white;
            border-radius: 12px;
            padding: 24px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            transition: all 0.3s ease;
            border: 1px solid #e1e8ed;
        }
        .app-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
        }
        .app-card h3 {
            margin: 0 0 12px 0;
            color: #2c3e50;
            font-size: 1.3rem;
            font-weight: 600;
        }
        .app-card p {
            margin: 0 0 20px 0;
            color: #7f8c8d;
            line-height: 1.5;
        }
        .app-dependencies {
            margin: 15px 0;
        }
        .dependency-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-top: 8px;
        }
        .dependency-tag {
            background: #f8f9fa;
            color: #495057;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 0.8rem;
            border: 1px solid #dee2e6;
        }
        .dependency-tag.service {
            background: #e3f2fd;
            color: #1976d2;
            border-color: #bbdefb;
        }
        .dependency-tag.model {
            background: #f3e5f5;
            color: #7b1fa2;
            border-color: #e1bee7;
        }
        .app-actions {
            display: flex;
            gap: 10px;
            align-items: center;
        }
        .app-link {
            background: #667eea;
            color: white;
            padding: 10px 20px;
            border-radius: 6px;
            text-decoration: none;
            font-weight: 500;
            transition: all 0.3s;
            display: inline-block;
        }
        .app-link:hover {
            background: #5a6fd8;
            transform: translateY(-1px);
        }
        .app-status {
            font-size: 0.9rem;
            padding: 4px 8px;
            border-radius: 4px;
            font-weight: 500;
        }
        .app-status.online {
            background: #d4edda;
            color: #155724;
        }
        .app-status.offline {
            background: #f8d7da;
            color: #721c24;
        }
        
        /* Admin Sub-Tabs Layout */
        .admin-container {
            display: flex;
            gap: 20px;
            max-width: 1400px;
            margin: 0 auto;
        }
        .admin-sidebar {
            width: 200px;
            background: white;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            height: fit-content;
            position: sticky;
            top: 20px;
        }
        .admin-sidebar h3 {
            margin: 0 0 20px 0;
            color: #333;
            font-size: 16px;
            border-bottom: 2px solid #667eea;
            padding-bottom: 10px;
        }
        .admin-sub-tabs {
            list-style: none;
            padding: 0;
            margin: 0;
        }
        .admin-sub-tab {
            margin-bottom: 8px;
        }
        .admin-sub-tab button {
            width: 100%;
            padding: 12px 16px;
            border: none;
            background: #f8f9fa;
            color: #666;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.2s;
            text-align: left;
            font-size: 14px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .admin-sub-tab button:hover {
            background: #e9ecef;
            color: #333;
        }
        .admin-sub-tab button.active {
            background: #667eea;
            color: white;
        }
        .admin-content {
            flex: 1;
            background: white;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .admin-sub-content {
            display: none;
        }
        .admin-sub-content.active {
            display: block;
        }
        .admin-sub-content h2 {
            margin-top: 0;
            color: #333;
            border-bottom: 2px solid #667eea;
            padding-bottom: 10px;
        }
        
        /* Overview Section Styles */
        .service-summary {
            margin-bottom: 30px;
        }
        .service-summary h3 {
            color: #333;
            margin-bottom: 15px;
        }
        .service-status-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }
        .status-card {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 15px;
            display: flex;
            align-items: center;
            gap: 12px;
            border: 1px solid #e9ecef;
        }
        .status-icon {
            font-size: 24px;
            width: 40px;
            text-align: center;
        }
        .status-info {
            flex: 1;
        }
        .status-name {
            font-weight: 600;
            color: #333;
            margin-bottom: 4px;
        }
        .status-indicator {
            font-size: 12px;
            padding: 2px 8px;
            border-radius: 12px;
            font-weight: 500;
        }
        .quick-actions {
            margin-top: 30px;
        }
        .quick-actions h3 {
            color: #333;
            margin-bottom: 15px;
        }
        .action-buttons {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }
        .action-buttons .btn {
            padding: 10px 20px;
            border-radius: 6px;
            text-decoration: none;
            font-weight: 500;
            transition: all 0.2s;
        }
        .action-buttons .btn-primary {
            background: #667eea;
            color: white;
            border: none;
        }
        .action-buttons .btn-primary:hover {
            background: #5a6fd8;
        }
        .action-buttons .btn-secondary {
            background: #6c757d;
            color: white;
            border: none;
        }
        .action-buttons .btn-secondary:hover {
            background: #5a6268;
        }
        
        /* Asset Statistics */
        .asset-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }
        .stat-card {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 15px;
            text-align: center;
            border: 1px solid #e9ecef;
        }
        .stat-icon {
            font-size: 24px;
            margin-bottom: 8px;
        }
        .stat-number {
            font-size: 24px;
            font-weight: bold;
            color: #667eea;
            margin-bottom: 4px;
        }
        .stat-label {
            font-size: 12px;
            color: #666;
            text-transform: uppercase;
        }

        /* Core Services Styles */
        .core-services {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 30px;
            border: 1px solid rgba(0, 0, 0, 0.1);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }
        .core-services h2 {
            margin-top: 0;
            color: #2c3e50;
            border-bottom: 2px solid #667eea;
            padding-bottom: 10px;
        }
        .services-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        .service-card {
            background: rgba(255, 255, 255, 0.7);
            border-radius: 10px;
            padding: 20px;
            border: 1px solid rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
        }
        .service-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }
        .service-header {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
        }
        .service-icon {
            font-size: 24px;
            margin-right: 12px;
        }
        .service-name {
            font-weight: 600;
            color: #2c3e50;
        }
        .service-status {
            display: flex;
            align-items: center;
            margin-top: 8px;
        }
        .status-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            margin-right: 8px;
        }
        .status-dot.online {
            background: #4CAF50;
        }
        .status-dot.offline {
            background: #f44336;
        }
        .status-text {
            font-size: 14px;
            color: #666;
        }

        /* Premium Model Management */
        .models-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 32px;
            margin-top: 24px;
        }
        
        .model-category {
            background: #ffffff;
            border-radius: 16px;
            padding: 24px;
            border: 1px solid #e2e8f0;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            font-family: 'Inter', sans-serif;
        }
        
        .model-category h3 {
            margin: 0 0 20px 0;
            color: #1e293b;
            font-size: 18px;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .model-list {
            display: flex;
            flex-direction: column;
            gap: 16px;
        }
        
        .model-item {
            background: #f8fafc;
            border-radius: 12px;
            padding: 20px;
            border: 1px solid #e2e8f0;
            transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        .model-item:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px -5px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        }
        
        .model-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 12px;
        }
        
        .model-name {
            font-weight: 600;
            color: #1e293b;
            font-size: 16px;
            font-family: 'Inter', sans-serif;
        }
        
        .model-status {
            font-size: 12px;
            padding: 6px 12px;
            border-radius: 20px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            font-family: 'Inter', sans-serif;
        }
        
        .model-status.running {
            background: #dbeafe;
            color: #1e40af;
        }
        
        .model-status.available {
            background: #dcfce7;
            color: #166534;
        }
        
        .model-status.unavailable {
            background: #fef2f2;
            color: #dc2626;
        }
        
        .model-default {
            font-size: 11px;
            color: #f59e0b;
            font-weight: 500;
            margin-left: 8px;
            display: flex;
            align-items: center;
            gap: 4px;
        }
        
        .model-usage {
            margin: 12px 0;
            font-size: 13px;
            color: #64748b;
            font-family: 'Inter', sans-serif;
        }
        
        .used-by-toggle {
            background: none;
            border: none;
            color: #3b82f6;
            cursor: pointer;
            font-size: 12px;
            font-weight: 500;
            padding: 4px 0;
            display: flex;
            align-items: center;
            gap: 4px;
            transition: color 0.2s;
        }
        
        .used-by-toggle:hover {
            color: #1d4ed8;
        }
        
        .used-by-list {
            margin-top: 8px;
            padding-left: 16px;
            font-size: 12px;
            color: #64748b;
            line-height: 1.5;
        }
        
        .used-by-list.hidden {
            display: none;
        }
        
        .model-actions {
            display: flex;
            gap: 8px;
            margin-top: 16px;
        }
        
        .model-btn {
            padding: 8px 12px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 12px;
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 6px;
            transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
            font-family: 'Inter', sans-serif;
        }
        
        .model-btn:hover {
            transform: scale(1.05);
        }
        
        .model-btn:active {
            transform: scale(0.95);
        }
        
        .model-btn.load {
            background: #10b981;
            color: white;
        }
        
        .model-btn.load:hover {
            background: #059669;
        }
        
        .model-btn.unload {
            background: #ef4444;
            color: white;
        }
        
        .model-btn.unload:hover {
            background: #dc2626;
        }
        
        .model-btn.pull {
            background: #f59e0b;
            color: white;
        }
        
        .model-btn.pull:hover {
            background: #d97706;
        }
        
        .model-btn.delete {
            background: #ef4444;
            color: white;
        }
        
        .model-btn.delete:hover {
            background: #dc2626;
        }
        
        .model-btn.info {
            background: #3b82f6;
            color: white;
        }
        
        .model-btn.info:hover {
            background: #2563eb;
        }

        /* Premium Service Management */
        .services-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
            gap: 24px;
            margin-top: 24px;
        }
        
        .service-control-card {
            background: #ffffff;
            border-radius: 16px;
            padding: 0;
            border: 1px solid #e2e8f0;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            overflow: hidden;
            position: relative;
            font-family: 'Inter', sans-serif;
        }
        
        .service-control-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
        }
        
        .service-control-card.critical {
            border-left: 4px solid #ef4444;
        }
        
        .service-control-card.critical::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, #ef4444, #f97316);
        }
        
        .service-header {
            padding: 24px 24px 16px 24px;
            border-bottom: 1px solid #f1f5f9;
        }
        
        .service-info h3 {
            margin: 0 0 8px 0;
            color: #1e293b;
            font-size: 18px;
            font-weight: 600;
            font-family: 'Inter', sans-serif;
        }
        
        .service-info p {
            color: #64748b;
            margin: 0 0 16px 0;
            font-size: 14px;
            line-height: 1.5;
            font-family: 'Inter', sans-serif;
        }
        
        .service-status {
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        
        .status-indicator {
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            font-family: 'Inter', sans-serif;
        }
        
        .status-indicator.online {
            background: #dcfce7;
            color: #166534;
        }
        
        .status-indicator.offline {
            background: #f1f5f9;
            color: #64748b;
        }
        
        .status-indicator.error {
            background: #fef2f2;
            color: #dc2626;
        }
        
        .service-controls {
            display: flex;
            gap: 8px;
        }
        
        .icon-btn {
            width: 36px;
            height: 36px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
            transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
        }
        
        .icon-btn:hover {
            transform: scale(1.05);
        }
        
        .icon-btn:active {
            transform: scale(0.95);
        }
        
        .icon-btn.start {
            background: #10b981;
            color: white;
        }
        
        .icon-btn.start:hover {
            background: #059669;
        }
        
        .icon-btn.stop {
            background: #ef4444;
            color: white;
        }
        
        .icon-btn.stop:hover {
            background: #dc2626;
        }
        
        .icon-btn.restart {
            background: #f59e0b;
            color: white;
        }
        
        .icon-btn.restart:hover {
            background: #d97706;
        }
        
        .icon-btn[title]:hover::after {
            content: attr(title);
            position: absolute;
            bottom: -32px;
            left: 50%;
            transform: translateX(-50%);
            background: #1e293b;
            color: white;
            padding: 6px 10px;
            border-radius: 6px;
            font-size: 12px;
            white-space: nowrap;
            z-index: 1000;
            font-family: 'Inter', sans-serif;
        }
        
        .service-details {
            padding: 16px 24px 24px 24px;
            background: #f8fafc;
            border-top: 1px solid #f1f5f9;
            display: none;
        }
        
        .service-details.expanded {
            display: block;
        }
        
        .detail-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
            gap: 16px;
        }
        
        .detail-item {
            display: flex;
            flex-direction: column;
            gap: 4px;
        }
        
        .detail-label {
            font-size: 12px;
            font-weight: 500;
            color: #64748b;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            font-family: 'Inter', sans-serif;
        }
        
        .detail-value {
            font-size: 14px;
            font-weight: 600;
            color: #1e293b;
            font-family: 'Inter', sans-serif;
        }
        
        .expand-btn {
            width: 100%;
            padding: 12px;
            background: transparent;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            color: #64748b;
            transition: all 0.2s;
            font-family: 'Inter', sans-serif;
        }
        
        .expand-btn:hover {
            background: #f1f5f9;
            color: #1e293b;
        }
        .status-indicator {
            font-size: 12px;
            padding: 4px 8px;
            border-radius: 12px;
            font-weight: 500;
            margin-right: 10px;
        }
        .status-indicator.online {
            background: #e8f5e8;
            color: #2e7d32;
        }
        .status-indicator.offline {
            background: #ffebee;
            color: #c62828;
        }

        /* Service Details */
        .service-details {
            margin-top: 15px;
            padding-top: 15px;
            border-top: 1px solid #e9ecef;
        }
        .detail-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 10px;
        }
        .detail-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 5px 0;
        }
        .detail-label {
            font-weight: 500;
            color: #666;
        }
        .detail-value {
            color: #333;
            font-weight: 500;
        }

        /* Model Management */
        .model-management {
            margin-top: 20px;
        }
        .model-actions {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }
        .model-actions .btn {
            padding: 10px 20px;
            border-radius: 6px;
            text-decoration: none;
            font-weight: 500;
            transition: all 0.2s;
            border: none;
            cursor: pointer;
        }
        .model-actions .btn-primary {
            background: #667eea;
            color: white;
        }
        .model-actions .btn-primary:hover {
            background: #5a6fd8;
        }
        .model-actions .btn-secondary {
            background: #6c757d;
            color: white;
        }
        .model-actions .btn-secondary:hover {
            background: #5a6268;
        }

        /* Dependency Visualization */
        .dependency-graph {
            display: flex;
            gap: 30px;
            margin-top: 20px;
        }
        .dependency-visualization {
            flex: 1;
            position: relative;
            background: #f8f9fa;
            border-radius: 10px;
            padding: 20px;
            min-height: 400px;
        }
        .service-node {
            position: absolute;
            background: white;
            border-radius: 8px;
            padding: 15px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            text-align: center;
            min-width: 120px;
        }
        .service-node.hub-gateway { top: 20px; left: 50%; transform: translateX(-50%); }
        .service-node.ollama { top: 120px; left: 20px; }
        .service-node.qdrant { top: 120px; left: 50%; transform: translateX(-50%); }
        .service-node.redis { top: 120px; right: 20px; }
        .service-node.onyx { top: 220px; left: 30%; }
        .service-node.contract-reviewer { top: 220px; right: 30%; }

        .node-icon {
            font-size: 24px;
            margin-bottom: 8px;
        }
        .node-label {
            font-weight: 600;
            color: #333;
            margin-bottom: 4px;
        }
        .node-status {
            font-size: 12px;
            padding: 2px 8px;
            border-radius: 12px;
            font-weight: 500;
        }
        .node-status.online {
            background: #e8f5e8;
            color: #2e7d32;
        }
        .node-status.offline {
            background: #ffebee;
            color: #c62828;
        }

        .dependency-arrow {
            position: absolute;
            height: 2px;
            background: #667eea;
            z-index: 1;
        }
        .dependency-arrow[data-from="contract-reviewer"][data-to="hub-gateway"] {
            top: 180px;
            right: 30%;
            width: 20%;
            transform: rotate(-45deg);
        }
        .dependency-arrow[data-from="hub-gateway"][data-to="ollama"] {
            top: 100px;
            left: 30%;
            width: 20%;
            transform: rotate(45deg);
        }
        .dependency-arrow[data-from="hub-gateway"][data-to="qdrant"] {
            top: 100px;
            left: 50%;
            width: 20%;
            transform: translateX(-50%);
        }
        .dependency-arrow[data-from="hub-gateway"][data-to="redis"] {
            top: 100px;
            right: 30%;
            width: 20%;
            transform: rotate(-45deg);
        }
        .dependency-arrow[data-from="hub-gateway"][data-to="onyx"] {
            top: 200px;
            left: 40%;
            width: 20%;
            transform: rotate(45deg);
        }
        .dependency-arrow[data-from="onyx"][data-to="ollama"] {
            top: 280px;
            left: 25%;
            width: 15%;
            transform: rotate(45deg);
        }
        .dependency-arrow[data-from="onyx"][data-to="qdrant"] {
            top: 280px;
            left: 50%;
            width: 15%;
            transform: translateX(-50%);
        }
        .dependency-arrow[data-from="onyx"][data-to="redis"] {
            top: 280px;
            right: 25%;
            width: 15%;
            transform: rotate(-45deg);
        }

        .dependency-info {
            flex: 1;
            background: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .dependency-info h4 {
            margin-top: 0;
            color: #333;
            border-bottom: 2px solid #667eea;
            padding-bottom: 10px;
        }
        .dependency-list {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        .dep-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px;
            background: #f8f9fa;
            border-radius: 6px;
        }
        .dep-service {
            font-weight: 600;
            color: #333;
        }
        .dep-depends {
            color: #666;
            font-style: italic;
        }
        .dep-status {
            font-size: 12px;
            padding: 2px 8px;
            border-radius: 12px;
            font-weight: 500;
        }
        .dep-status.healthy {
            background: #e8f5e8;
            color: #2e7d32;
        }
        .dep-status.unhealthy {
            background: #ffebee;
            color: #c62828;
        }

        /* System Monitoring */
        .system-monitoring {
            margin-top: 20px;
        }
        .monitoring-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        .monitor-card {
            background: rgba(255, 255, 255, 0.9);
            border-radius: 10px;
            padding: 20px;
            border: 1px solid rgba(0, 0, 0, 0.1);
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .monitor-card h3 {
            margin-top: 0;
            color: #333;
            border-bottom: 2px solid #667eea;
            padding-bottom: 10px;
        }
        .resource-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 0;
            border-bottom: 1px solid #f0f0f0;
        }
        .resource-item:last-child {
            border-bottom: none;
        }
        .resource-label {
            font-weight: 500;
            color: #666;
        }
        .resource-value {
            color: #333;
            font-weight: 600;
        }

        /* Logs and Operations */
        .logs-section {
            margin-top: 20px;
        }
        .logs-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        .logs-header h4 {
            margin: 0;
            color: #333;
        }
        .logs-controls {
            display: flex;
            gap: 10px;
        }
        .logs-controls .btn {
            padding: 6px 12px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
            font-weight: 500;
        }
        .logs-controls .btn-primary {
            background: #667eea;
            color: white;
        }
        .logs-controls .btn-secondary {
            background: #6c757d;
            color: white;
        }
        .logs-container {
            background: #1e1e1e;
            border-radius: 8px;
            padding: 15px;
            max-height: 300px;
            overflow-y: auto;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            line-height: 1.4;
        }
        .log-entry {
            margin-bottom: 8px;
            padding: 4px 0;
            border-bottom: 1px solid #333;
        }
        .log-entry:last-child {
            border-bottom: none;
        }
        .log-timestamp {
            color: #888;
            margin-right: 10px;
        }
        .log-level {
            font-weight: bold;
            margin-right: 10px;
        }
        .log-level.info {
            color: #4CAF50;
        }
        .log-level.warning {
            color: #ff9800;
        }
        .log-level.error {
            color: #f44336;
        }
        .log-level.debug {
            color: #2196F3;
        }
        .log-message {
            color: #fff;
        }
        .log-service {
            color: #9C27B0;
            font-weight: bold;
            margin-right: 10px;
        }

        /* Operation History */
        .operation-history {
            margin-top: 20px;
        }
        .operation-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px;
            background: #f8f9fa;
            border-radius: 6px;
            margin-bottom: 8px;
            border-left: 4px solid #667eea;
        }
        .operation-item.success {
            border-left-color: #4CAF50;
        }
        .operation-item.error {
            border-left-color: #f44336;
        }
        .operation-item.warning {
            border-left-color: #ff9800;
        }
        .operation-details {
            flex: 1;
        }
        .operation-service {
            font-weight: 600;
            color: #333;
        }
        .operation-action {
            color: #666;
            font-size: 14px;
        }
        .operation-timestamp {
            color: #888;
            font-size: 12px;
        }
        .operation-status {
            font-size: 12px;
            padding: 2px 8px;
            border-radius: 12px;
            font-weight: 500;
        }
        .operation-status.success {
            background: #e8f5e8;
            color: #2e7d32;
        }
        .operation-status.error {
            background: #ffebee;
            color: #c62828;
        }
        .operation-status.warning {
            background: #fff3e0;
            color: #e65100;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ü§ñ ABS AI Hub</h1>
            <p>Legal Workstation - AI-powered legal tools and document analysis</p>
            <div style="margin-top: 20px;">
                <a href="manage.html" class="btn" style="margin-right: 10px;">Manage Assets</a>
                <a href="http://localhost:8081/catalog" target="_blank" class="btn btn-secondary">View Catalog API</a>
            </div>
        </div>

        <!-- Enhanced Navigation Tabs -->
        <div class="nav-tabs">
            <button class="nav-tab active" onclick="showTab('apps')">üì± Apps</button>
            <button class="nav-tab" onclick="showTab('admin')">‚öôÔ∏è Admin</button>
        </div>

        <!-- Apps Tab -->
        <div id="apps-tab" class="tab-content active">
            <h2>üì± Applications</h2>
            <p>Discover and launch AI-powered applications available in your workspace.</p>
            
            <!-- Applications -->
            <div class="apps-grid" id="apps-grid">
                <!-- Apps will be loaded dynamically -->
            </div>
        </div>
            
        <!-- Admin Tab -->
        <div id="admin-tab" class="tab-content">
            <div class="admin-container">
                <!-- Admin Sidebar -->
                <div class="admin-sidebar">
                    <h3>Admin Panel</h3>
                    <ul class="admin-sub-tabs">
                        <li class="admin-sub-tab">
                            <button onclick="showAdminSubTab('overview')" class="active">üìä Overview</button>
                        </li>
                        <li class="admin-sub-tab">
                            <button onclick="showAdminSubTab('services')">‚öôÔ∏è Services</button>
                        </li>
                        <li class="admin-sub-tab">
                            <button onclick="showAdminSubTab('models')">üß† Models</button>
                        </li>
                        <li class="admin-sub-tab">
                            <button onclick="showAdminSubTab('dependencies')">üîó Dependencies</button>
                        </li>
                        <li class="admin-sub-tab">
                            <button onclick="showAdminSubTab('system')">üìà System</button>
                        </li>
                    </ul>
        </div>

                <!-- Admin Content -->
                <div class="admin-content">
                    <!-- Overview Sub-Tab -->
                    <div id="overview-sub" class="admin-sub-content active">
                        <h2>üìä System Overview</h2>
                        
                        <!-- Service Status Summary -->
                        <div class="service-summary">
                            <h3>Service Status</h3>
                            <div class="service-status-grid">
                                <div class="status-card">
                                    <div class="status-icon">ü§ñ</div>
                                    <div class="status-info">
                                        <div class="status-name">Ollama</div>
                                        <div class="status-indicator" id="ollama-status-summary">Checking...</div>
                        </div>
                        </div>
                                <div class="status-card">
                                    <div class="status-icon">üóÑÔ∏è</div>
                                    <div class="status-info">
                                        <div class="status-name">Qdrant</div>
                                        <div class="status-indicator" id="qdrant-status-summary">Checking...</div>
                        </div>
                    </div>
                                <div class="status-card">
                                    <div class="status-icon">‚ö°</div>
                                    <div class="status-info">
                                        <div class="status-name">Redis</div>
                                        <div class="status-indicator" id="redis-status-summary">Checking...</div>
                </div>
                        </div>
                                <div class="status-card">
                                    <div class="status-icon">üåê</div>
                                    <div class="status-info">
                                        <div class="status-name">Hub Gateway</div>
                                        <div class="status-indicator" id="gateway-status-summary">Checking...</div>
                    </div>
                </div>
            </div>
        </div>

                        <!-- Asset Statistics -->
                        <div class="asset-overview">
                            <h3>Asset Statistics</h3>
                            <div class="asset-stats">
                                <div class="stat-card">
                                    <div class="stat-icon">üì±</div>
                                    <div class="stat-number" id="app-count">-</div>
                                    <div class="stat-label">Applications</div>
                </div>
                                <div class="stat-card">
                                    <div class="stat-icon">‚öôÔ∏è</div>
                                    <div class="stat-number" id="service-count">-</div>
                                    <div class="stat-label">Services</div>
            </div>
                                <div class="stat-card">
                                    <div class="stat-icon">üß†</div>
                                    <div class="stat-number" id="model-count">-</div>
                                    <div class="stat-label">Models</div>
                </div>
                                <div class="stat-card">
                                    <div class="stat-icon">üîß</div>
                                    <div class="stat-number" id="tool-count">-</div>
                                    <div class="stat-label">Tools</div>
            </div>
                </div>
            </div>

                        <!-- Quick Actions -->
                        <div class="quick-actions">
                            <h3>Quick Actions</h3>
                            <div class="action-buttons">
                                <a href="manage.html" class="btn btn-primary">Open Asset Manager</a>
                                <button class="btn btn-secondary" onclick="refreshAllStatus()">Refresh All</button>
                                <button class="btn btn-secondary" onclick="restartAllServices()">Restart All Services</button>
            </div>
        </div>
        </div>

                    <!-- Services Sub-Tab -->
                    <div id="services-sub" class="admin-sub-content">
                        <h2>‚öôÔ∏è Service Management</h2>
                <div class="services-grid">
                    <div class="service-control-card critical" id="ollama-control">
                        <div class="service-header">
                            <div class="service-info">
                                <h3>ü¶ô Ollama (LLM Server)</h3>
                                <p>Large Language Model serving with lazy-loaded models</p>
                            </div>
                            <div class="service-status">
                                <span class="status-indicator" id="ollama-status">Checking...</span>
                                <div class="service-controls">
                                    <button class="icon-btn start" title="Start Service" onclick="toggleService('ollama', true)">‚ñ∂Ô∏è</button>
                                    <button class="icon-btn stop" title="Stop Service" onclick="toggleService('ollama', false)">‚èπÔ∏è</button>
                                    <button class="icon-btn restart" title="Restart Service" onclick="restartService('ollama')">‚ôªÔ∏è</button>
                                </div>
                            </div>
                        </div>
                        <div class="service-details" id="ollama-details">
                            <div class="detail-grid">
                                <div class="detail-item">
                                    <span class="detail-label">Status</span>
                                    <span class="detail-value" id="ollama-status-text">Checking...</span>
                                </div>
                                <div class="detail-item">
                                    <span class="detail-label">Models</span>
                                    <span class="detail-value" id="ollama-models">-</span>
                                </div>
                                <div class="detail-item">
                                    <span class="detail-label">Memory</span>
                                    <span class="detail-value" id="ollama-memory">-</span>
                                </div>
                                <div class="detail-item">
                                    <span class="detail-label">Version</span>
                                    <span class="detail-value" id="ollama-version">-</span>
                                </div>
                            </div>
                        </div>
                        <button class="expand-btn" onclick="toggleServiceDetails('ollama')">View Details</button>
                    </div>

                    <div class="service-control-card critical" id="qdrant-control">
                        <div class="service-header">
                            <div class="service-info">
                                <h3>üóÑÔ∏è Qdrant (Vector Database)</h3>
                                <p>Vector database for embeddings and similarity search</p>
                            </div>
                            <div class="service-status">
                                <span class="status-indicator" id="qdrant-status">Checking...</span>
                                <div class="service-controls">
                                    <button class="icon-btn start" title="Start Service" onclick="toggleService('qdrant', true)">‚ñ∂Ô∏è</button>
                                    <button class="icon-btn stop" title="Stop Service" onclick="toggleService('qdrant', false)">‚èπÔ∏è</button>
                                    <button class="icon-btn restart" title="Restart Service" onclick="restartService('qdrant')">‚ôªÔ∏è</button>
                                </div>
                            </div>
                        </div>
                        <div class="service-details" id="qdrant-details">
                            <div class="detail-grid">
                                <div class="detail-item">
                                    <span class="detail-label">Status</span>
                                    <span class="detail-value" id="qdrant-status-text">Checking...</span>
                                </div>
                                <div class="detail-item">
                                    <span class="detail-label">Collections</span>
                                    <span class="detail-value" id="qdrant-collections">-</span>
                                </div>
                                <div class="detail-item">
                                    <span class="detail-label">Vectors</span>
                                    <span class="detail-value" id="qdrant-vectors">-</span>
                                </div>
                                <div class="detail-item">
                                    <span class="detail-label">Version</span>
                                    <span class="detail-value" id="qdrant-version">-</span>
                                </div>
                            </div>
                        </div>
                        <button class="expand-btn" onclick="toggleServiceDetails('qdrant')">View Details</button>
                    </div>

                    <div class="service-control-card" id="redis-control">
                        <div class="service-header">
                            <div class="service-info">
                                <h3>‚ö° Redis (Cache)</h3>
                                <p>In-memory cache for performance optimization</p>
                            </div>
                            <div class="service-status">
                                <span class="status-indicator" id="redis-status">Checking...</span>
                                <div class="service-controls">
                                    <button class="icon-btn start" title="Start Service" onclick="toggleService('redis', true)">‚ñ∂Ô∏è</button>
                                    <button class="icon-btn stop" title="Stop Service" onclick="toggleService('redis', false)">‚èπÔ∏è</button>
                                    <button class="icon-btn restart" title="Restart Service" onclick="restartService('redis')">‚ôªÔ∏è</button>
                                </div>
                            </div>
                        </div>
                        <div class="service-details" id="redis-details">
                            <div class="detail-grid">
                                <div class="detail-item">
                                    <span class="detail-label">Status</span>
                                    <span class="detail-value" id="redis-status-text">Checking...</span>
                                </div>
                                <div class="detail-item">
                                    <span class="detail-label">Keys</span>
                                    <span class="detail-value" id="redis-keys">-</span>
                                </div>
                                <div class="detail-item">
                                    <span class="detail-label">Memory</span>
                                    <span class="detail-value" id="redis-memory">-</span>
                                </div>
                                <div class="detail-item">
                                    <span class="detail-label">Version</span>
                                    <span class="detail-value" id="redis-version">-</span>
                                </div>
                            </div>
                        </div>
                        <button class="expand-btn" onclick="toggleServiceDetails('redis')">View Details</button>
                    </div>

                    <div class="service-control-card" id="gateway-control">
                        <div class="service-header">
                            <div class="service-info">
                                <h3>üåê Hub Gateway</h3>
                                <p>Central API gateway and service orchestrator</p>
                            </div>
                            <div class="service-status">
                                <span class="status-indicator" id="gateway-status">Checking...</span>
                                <div class="service-controls">
                                    <button class="icon-btn start" title="Start Service" onclick="toggleService('gateway', true)">‚ñ∂Ô∏è</button>
                                    <button class="icon-btn stop" title="Stop Service" onclick="toggleService('gateway', false)">‚èπÔ∏è</button>
                                    <button class="icon-btn restart" title="Restart Service" onclick="restartService('gateway')">‚ôªÔ∏è</button>
                                </div>
                            </div>
                        </div>
                        <div class="service-details" id="gateway-details">
                            <div class="detail-grid">
                                <div class="detail-item">
                                    <span class="detail-label">Status</span>
                                    <span class="detail-value" id="gateway-status-text">Checking...</span>
                                </div>
                                <div class="detail-item">
                                    <span class="detail-label">Version</span>
                                    <span class="detail-value" id="gateway-version">-</span>
                                </div>
                                <div class="detail-item">
                                    <span class="detail-label">Uptime</span>
                                    <span class="detail-value" id="gateway-uptime">-</span>
                                </div>
                            </div>
                        </div>
                        <button class="expand-btn" onclick="toggleServiceDetails('gateway')">View Details</button>
                    </div>
                </div>
                
                <!-- Service Operation History -->
                <div class="operation-history">
                    <h3>üìã Recent Service Operations</h3>
                    <div id="service-operations">
                        <div class="operation-item success">
                            <div class="operation-details">
                                <div class="operation-service">Hub Gateway</div>
                                <div class="operation-action">Service started successfully</div>
                                <div class="operation-timestamp">Just now</div>
                            </div>
                            <span class="operation-status success">Success</span>
                        </div>
                        <div class="operation-item success">
                            <div class="operation-details">
                                <div class="operation-service">Ollama</div>
                                <div class="operation-action">Model loaded: llama3.2:latest</div>
                                <div class="operation-timestamp">2 minutes ago</div>
                            </div>
                            <span class="operation-status success">Success</span>
                        </div>
                        <div class="operation-item warning">
                            <div class="operation-details">
                                <div class="operation-service">Qdrant</div>
                                <div class="operation-action">High memory usage detected</div>
                                <div class="operation-timestamp">5 minutes ago</div>
                            </div>
                            <span class="operation-status warning">Warning</span>
                        </div>
                    </div>
                </div>

                <!-- Service Logs -->
                <div class="logs-section">
                    <div class="logs-header">
                        <h4>üìã Service Logs</h4>
                        <div class="logs-controls">
                            <select id="service-log-selector" onchange="loadServiceLogs()">
                                <option value="ollama">Ollama</option>
                                <option value="qdrant">Qdrant</option>
                                <option value="redis">Redis</option>
                                <option value="gateway">Hub Gateway</option>
                            </select>
                            <button class="btn btn-primary" onclick="refreshServiceLogs()">Refresh</button>
                            <button class="btn btn-secondary" onclick="clearServiceLogs()">Clear</button>
                        </div>
                    </div>
                    <div class="logs-container" id="service-logs">
                        <div class="log-entry">
                            <span class="log-timestamp">[‚ñ∂Ô∏è Loading...]</span>
                            <span class="log-level info">INFO</span>
                            <span class="log-service">SYSTEM</span>
                            <span class="log-message">Select a service to view logs...</span>
                        </div>
                    </div>
                </div>
            </div>

                    <!-- Models Sub-Tab -->
                    <div id="models-sub" class="admin-sub-content">
                        <h2>üß† Model Management</h2>
                        <div class="model-management">
                            <div class="model-actions">
                                <button class="btn btn-primary" onclick="refreshModels()">Refresh Models</button>
                                <button class="btn btn-secondary" onclick="loadAllModels()">‚ñ∂Ô∏è Load All Models</button>
                                <button class="btn btn-secondary" onclick="clearModelLogs()">Clear Logs</button>
                            </div>
                            <div class="models-grid" id="admin-models-grid">
                                <!-- Models will be loaded here -->
                    </div>

                            <!-- Model Operation Logs -->
                            <div class="logs-section">
                                <div class="logs-header">
                                    <h4>üìã Model Operation Logs</h4>
                                    <div class="logs-controls">
                                        <button class="btn btn-primary" onclick="refreshModelLogs()">Refresh</button>
                                        <button class="btn btn-secondary" onclick="toggleLogStreaming()">Toggle Live</button>
                            </div>
                            </div>
                                <div class="logs-container" id="model-logs">
                                    <div class="log-entry">
                                        <span class="log-timestamp">[‚ñ∂Ô∏è Loading...]</span>
                                        <span class="log-level info">INFO</span>
                                        <span class="log-service">SYSTEM</span>
                                        <span class="log-message">Initializing model logs...</span>
                        </div>
                        </div>
                    </div>
                </div>
            </div>

                    <!-- Dependencies Sub-Tab -->
                    <div id="dependencies-sub" class="admin-sub-content">
                <h2>üîó Service Dependencies</h2>
                        <div class="dependency-graph">
                            <div class="dependency-visualization">
                        <div class="service-node hub-gateway">
                            <div class="node-icon">üåê</div>
                            <div class="node-label">Hub Gateway</div>
                            <div class="node-status online">Online</div>
                        </div>
                        <div class="service-node ollama">
                            <div class="node-icon">ü§ñ</div>
                            <div class="node-label">Ollama</div>
                            <div class="node-status online">Online</div>
                        </div>
                        <div class="service-node qdrant">
                            <div class="node-icon">üóÑÔ∏è</div>
                            <div class="node-label">Qdrant</div>
                            <div class="node-status online">Online</div>
                        </div>
                        <div class="service-node redis">
                            <div class="node-icon">‚ö°</div>
                            <div class="node-label">Redis</div>
                            <div class="node-status online">Online</div>
                        </div>
                        <div class="service-node onyx">
                            <div class="node-icon">ü§ñ</div>
                            <div class="node-label">Onyx</div>
                            <div class="node-status online">Online</div>
                        </div>
                        <div class="service-node contract-reviewer">
                            <div class="node-icon">üìÑ</div>
                            <div class="node-label">Contract Reviewer</div>
                            <div class="node-status online">Online</div>
                        </div>
                        
                        <!-- Dependency arrows -->
                        <div class="dependency-arrow" data-from="contract-reviewer" data-to="hub-gateway"></div>
                        <div class="dependency-arrow" data-from="hub-gateway" data-to="ollama"></div>
                        <div class="dependency-arrow" data-from="hub-gateway" data-to="qdrant"></div>
                        <div class="dependency-arrow" data-from="hub-gateway" data-to="redis"></div>
                        <div class="dependency-arrow" data-from="hub-gateway" data-to="onyx"></div>
                        <div class="dependency-arrow" data-from="onyx" data-to="ollama"></div>
                        <div class="dependency-arrow" data-from="onyx" data-to="qdrant"></div>
                        <div class="dependency-arrow" data-from="onyx" data-to="redis"></div>
                    </div>
                    <div class="dependency-info">
                        <h4>Dependency Status</h4>
                        <div class="dependency-list" id="dependency-list">
                            <div class="dep-item">
                                <span class="dep-service">Contract Reviewer</span>
                                <span class="dep-depends">‚Üí Hub Gateway</span>
                                <span class="dep-status healthy">‚úì Healthy</span>
                            </div>
                            <div class="dep-item">
                                <span class="dep-service">Hub Gateway</span>
                                <span class="dep-depends">‚Üí Ollama, Qdrant, Redis</span>
                                <span class="dep-status healthy">‚úì Healthy</span>
                            </div>
                                    <div class="dep-item">
                                        <span class="dep-service">Onyx</span>
                                        <span class="dep-depends">‚Üí Ollama, Qdrant, Redis</span>
                                        <span class="dep-status healthy">‚úì Healthy</span>
                        </div>
                    </div>
                </div>
            </div>
            </div>

                    <!-- System Sub-Tab -->
                    <div id="system-sub" class="admin-sub-content">
                        <h2>üìà System Monitoring</h2>
                        <div class="system-monitoring">
                            <div class="monitoring-grid">
                                <div class="monitor-card">
                                    <h3>System Resources</h3>
                                    <div class="resource-item">
                                        <span class="resource-label">CPU Usage:</span>
                                        <span class="resource-value" id="cpu-usage">-</span>
                                    </div>
                                    <div class="resource-item">
                                        <span class="resource-label">Memory Usage:</span>
                                        <span class="resource-value" id="memory-usage">-</span>
                                    </div>
                                    <div class="resource-item">
                                        <span class="resource-label">Disk Usage:</span>
                                        <span class="resource-value" id="disk-usage">-</span>
                                    </div>
                                </div>
                                <div class="monitor-card">
                                    <h3>Network Status</h3>
                                    <div class="resource-item">
                                        <span class="resource-label">Active Connections:</span>
                                        <span class="resource-value" id="active-connections">-</span>
                                    </div>
                                    <div class="resource-item">
                                        <span class="resource-label">Requests/min:</span>
                                        <span class="resource-value" id="requests-per-minute">-</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Collection Management -->
                        <div class="monitor-card">
                            <h3>üóÑÔ∏è Qdrant Collections</h3>
                            <div id="collections-list">
                                <div class="resource-item">
                                    <span class="resource-label">‚ñ∂Ô∏è Loading collections...</span>
                                    <span class="resource-value">-</span>
                                </div>
                            </div>
                            <div style="margin-top: 15px;">
                                <button class="btn btn-primary" onclick="refreshCollections()">Refresh Collections</button>
                                <button class="btn btn-secondary" onclick="showCreateCollection()">Create Collection</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Tab Functions
        function showTab(tabName) {
            // Hide all tab contents
            const tabContents = document.querySelectorAll('.tab-content');
            tabContents.forEach(content => content.classList.remove('active'));
            
            // Show selected tab content
            const selectedContent = document.getElementById(tabName + '-tab');
            if (selectedContent) {
                selectedContent.classList.add('active');
            }
            
            // Update tab buttons
            const tabButtons = document.querySelectorAll('.nav-tab');
            tabButtons.forEach(button => button.classList.remove('active'));
            
            const clickedTab = document.querySelector(`[onclick="showTab('${tabName}')"]`);
            if (clickedTab) {
                clickedTab.classList.add('active');
            }
            
            // ‚ñ∂Ô∏è Load data when specific tabs are shown
            if (tabName === 'admin') {
                loadAdminData();
            } else if (tabName === 'apps') {
                loadAppsData();
            }
        }

        // Admin Sub-Tab Functions
        function showAdminSubTab(subTabName) {
            // Hide all sub-content
            const subContents = document.querySelectorAll('.admin-sub-content');
            subContents.forEach(content => content.classList.remove('active'));
            
            // Show selected sub-content
            const selectedContent = document.getElementById(subTabName + '-sub');
            if (selectedContent) {
                selectedContent.classList.add('active');
            }
            
            // Update sidebar buttons
            const subTabButtons = document.querySelectorAll('.admin-sub-tab button');
            subTabButtons.forEach(button => button.classList.remove('active'));
            
            const clickedButton = document.querySelector(`[onclick="showAdminSubTab('${subTabName}')"]`);
            if (clickedButton) {
                clickedButton.classList.add('active');
            }
            
            // ‚ñ∂Ô∏è Load specific data for the sub-tab
            switch(subTabName) {
                case 'overview':
                    loadOverviewData();
                        break;
                case 'services':
                    loadServicesData();
                        break;
                case 'models':
                    loadModelsData();
                    break;
                case 'dependencies':
                    loadDependenciesData();
                    break;
                case 'system':
                    loadSystemData();
                        break;
                }
            }

        async function loadAdminData() {
            // Initialize overview sub-tab by default
            showAdminSubTab('overview');
            await loadOverviewData();
        }

        // Apps Tab Functions
        async function loadAppsData() {
            try {
                const response = await fetch('http://localhost:8081/assets');
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                const data = await response.json();
                
                console.log('Apps data response:', data);
                console.log('Data keys:', Object.keys(data));
                
                const appsGrid = document.getElementById('apps-grid');
                if (!appsGrid) return;
                
                // Handle different response formats
                let assets = [];
                if (Array.isArray(data)) {
                    // Direct array response (correct format)
                    assets = data;
                } else if (data.value && Array.isArray(data.value)) {
                    // PowerShell wrapped format
                    assets = data.value;
                } else if (data.assets && Array.isArray(data.assets)) {
                    // Legacy format
                    assets = data.assets;
                } else {
                    console.error('Unexpected data format:', data);
                    appsGrid.innerHTML = '<div class="error">Unexpected data format received from server.</div>';
                    return;
                }
                
                // Filter only app assets
                const apps = assets.filter(asset => asset.class === 'app');
                
                if (apps.length === 0) {
                    appsGrid.innerHTML = '<div class="no-apps">No applications found in catalog.</div>';
                    return;
                }
                
                // Generate app cards
                appsGrid.innerHTML = apps.map(app => {
                    const policy = app.policy || {};
                    const allowedModels = policy.allowed_models || [];
                    const allowedEmbeddings = policy.allowed_embeddings || [];
                    
                    // Get app icon based on app ID
                    const getAppIcon = (appId) => {
                        const icons = {
                            'onyx-assistant': 'ü§ñ',
                            'contract-reviewer': 'üìÑ',
                            'rag-pdf-voice': 'üé§',
                            'deposition-summarizer': 'üìù',
                            'open-webui': 'üåê'
                        };
                        return icons[appId] || 'üì±';
                    };
                    
                    // Generate dependency tags
                    const dependencyTags = [];
                    
                    const appId = app.id;
                    
                    // Add service dependencies
                    if (appId === 'onyx-assistant' || appId === 'rag-pdf-voice') {
                        dependencyTags.push('<span class="dependency-tag service">Qdrant</span>');
                    }
                    if (appId === 'onyx-assistant') {
                        dependencyTags.push('<span class="dependency-tag service">Redis</span>');
                    }
                    
                    // Add model dependencies (show first 3)
                    const allModels = [...allowedModels, ...allowedEmbeddings];
                    allModels.slice(0, 3).forEach(model => {
                        const isEmbedding = allowedEmbeddings.includes(model);
                        dependencyTags.push(`<span class="dependency-tag model">${model}${isEmbedding ? ' (embed)' : ''}</span>`);
                    });
                    
                    if (allModels.length > 3) {
                        dependencyTags.push(`<span class="dependency-tag">+${allModels.length - 3} more</span>`);
                    }
                    
                    const appUrl = app.metadata?.url || `/${appId}/`;
                    
                    return `
                        <div class="app-card">
                            <h3>${getAppIcon(appId)} ${app.name}</h3>
                            <p>${app.description}</p>
                            <div class="app-dependencies">
                                <strong>Dependencies:</strong>
                                <div class="dependency-tags">
                                    ${dependencyTags.join('')}
                                </div>
                            </div>
                            <div class="app-actions">
                                <a href="${appUrl}" class="app-link" target="_blank">Open ${app.name}</a>
                                <span class="app-status offline" id="app-status-${appId}">Checking...</span>
                            </div>
                        </div>
                    `;
                }).join('');
                
                // Set default status for all apps to avoid console errors
                apps.forEach(app => {
                    const statusElement = document.getElementById(`app-status-${app.id}`);
                    if (statusElement) {
                        // Set reasonable defaults based on app type
                        if (app.id === 'onyx-assistant') {
                            statusElement.textContent = 'Online';
                            statusElement.className = 'app-status online';
                        } else {
                            statusElement.textContent = 'Offline';
                            statusElement.className = 'app-status offline';
                        }
                    }
                });
                
            } catch (error) {
                console.error('Error loading apps:', error);
                console.error('Error details:', error.message);
                const appsGrid = document.getElementById('apps-grid');
                if (appsGrid) {
                    appsGrid.innerHTML = `
                        <div class="error">
                            <h3>Failed to load applications</h3>
                            <p>Error: ${error.message}</p>
                            <p>Please check the console for more details.</p>
                            <button onclick="loadAppsData()" class="btn btn-secondary">Retry</button>
                        </div>
                    `;
                }
            }
        }
        
        async function checkAppStatus(appId, appUrl) {
            if (!appUrl) return;
            
            const statusElement = document.getElementById(`app-status-${appId}`);
            if (!statusElement) return;
            
            // Skip status checking for apps that are known to cause console errors
            // This prevents console spam while still showing the apps
            const problematicPorts = ['8080', '8000', '7860', '3200'];
            const isProblematic = problematicPorts.some(port => appUrl.includes(`localhost:${port}`));
            
            if (isProblematic) {
                // Set a reasonable default status based on the app
                if (appUrl.includes('localhost:8000')) {
                    statusElement.textContent = 'Online'; // Onyx is usually running
                    statusElement.className = 'app-status online';
                } else {
                    statusElement.textContent = 'Offline'; // Others are likely offline
                    statusElement.className = 'app-status offline';
                }
                return;
            }
            
            // For apps that don't cause issues, try a simple status check
            try {
                const controller = new AbortController();
                const timeoutId = setTimeout(() => controller.abort(), 2000);
                
                const response = await fetch(appUrl, { 
                    method: 'GET',
                    signal: controller.signal,
                    mode: 'no-cors' // This prevents CORS errors but still shows network errors
                });
                
                clearTimeout(timeoutId);
                statusElement.textContent = 'Online';
                statusElement.className = 'app-status online';
            } catch (error) {
                // Silently handle errors - don't spam console
                statusElement.textContent = 'Offline';
                statusElement.className = 'app-status offline';
            }
        }

        async function loadOverviewData() {
            await loadAssetOverview();
            await updateServiceSummary();
        }

        async function loadServicesData() {
            await checkServiceStatus();
            await loadServiceOperations();
        }

        async function loadModelsData() {
            await checkModelStatus();
            await loadAdminModels();
        }

        async function loadDependenciesData() {
            await updateDependencyStatus();
        }

        async function loadSystemData() {
            await updateSystemMetrics();
            await loadCollections();
        }

        async function loadAssetOverview() {
            try {
                const response = await fetch('http://localhost:8081/assets');
                if (response.ok) {
                    const data = await response.json();
                    updateAssetStats(data);
                } else {
                    console.error('Failed to load assets:', response.status);
                }
            } catch (error) {
                console.error('Error loading assets:', error);
            }
        }

        function updateAssetStats(data) {
            const stats = {
                app: 0,
                service: 0,
                model: 0,
                tool: 0
            };
            
            // Handle different response formats
            let assets = [];
            if (Array.isArray(data)) {
                // Direct array response (correct format)
                assets = data;
            } else if (data.value && Array.isArray(data.value)) {
                // PowerShell wrapped format
                assets = data.value;
            } else if (data.assets && Array.isArray(data.assets)) {
                // Legacy format
                assets = data.assets;
            }
            
            assets.forEach(asset => {
                if (stats.hasOwnProperty(asset.class)) {
                    stats[asset.class]++;
                }
            });
            
            document.getElementById('app-count').textContent = stats.app;
            document.getElementById('service-count').textContent = stats.service;
            document.getElementById('model-count').textContent = stats.model;
            document.getElementById('tool-count').textContent = stats.tool;
        }

        async function updateServiceSummary() {
            // Update summary status indicators
            const services = ['ollama', 'qdrant', 'redis', 'gateway'];
            for (const service of services) {
                const summaryElement = document.getElementById(service + '-status-summary');
                if (summaryElement) {
                    summaryElement.textContent = 'Online';
                    summaryElement.className = 'status-indicator';
                }
            }
        }

        async function refreshAllStatus() {
            await loadAssetOverview();
            await updateServiceSummary();
        }

        async function restartAllServices() {
            console.log('Restarting all services...');
            await refreshAllStatus();
        }

        // Service Management Functions
        async function checkServiceStatus() {
            try {
                const response = await fetch('http://localhost:8081/admin/services/status');
                if (response.ok) {
                    const services = await response.json();
                    
                    // Update service status indicators and detailed metrics
                    Object.keys(services).forEach(serviceName => {
                        const service = services[serviceName];
                        const isOnline = service.status === 'online';
                        
                        // Update status indicators
                        const statusElement = document.getElementById(serviceName + '-status');
                        const statusTextElement = document.getElementById(serviceName + '-status-text');
                        
                        if (statusElement && statusTextElement) {
                            statusElement.textContent = isOnline ? 'Online' : 'Offline';
                            statusElement.className = `status-indicator ${isOnline ? 'online' : 'offline'}`;
                            statusTextElement.textContent = isOnline ? 'Online' : 'Offline';
                        }
                        
                        // Update detailed metrics based on service type
                        if (isOnline) {
                            if (serviceName === 'ollama') {
                                // Update Ollama metrics
                                const modelsElement = document.getElementById('ollama-models');
                                const memoryElement = document.getElementById('ollama-memory');
                                const versionElement = document.getElementById('ollama-version');
                                
                                if (modelsElement) {
                                    modelsElement.textContent = service.model_count || service.models?.length || '0';
                                }
                                if (memoryElement) {
                                    memoryElement.textContent = service.memory_used || '-';
                                }
                                if (versionElement) {
                                    versionElement.textContent = service.version || '-';
                                }
                            } else if (serviceName === 'qdrant') {
                                // Update Qdrant metrics
                                const collectionsElement = document.getElementById('qdrant-collections');
                                const vectorsElement = document.getElementById('qdrant-vectors');
                                const versionElement = document.getElementById('qdrant-version');
                                
                                if (collectionsElement) {
                                    collectionsElement.textContent = service.collection_count || service.collections?.length || '0';
                                }
                                if (vectorsElement) {
                                    vectorsElement.textContent = service.total_vectors || '-';
                                }
                                if (versionElement) {
                                    versionElement.textContent = service.version || '-';
                                }
                            } else if (serviceName === 'redis') {
                                // Update Redis metrics
                                const keysElement = document.getElementById('redis-keys');
                                const memoryElement = document.getElementById('redis-memory');
                                const versionElement = document.getElementById('redis-version');
                                
                                if (keysElement) {
                                    keysElement.textContent = service.keys || '0';
                                }
                                if (memoryElement) {
                                    memoryElement.textContent = service.memory_used || '-';
                                }
                                if (versionElement) {
                                    versionElement.textContent = service.version || '-';
                                }
                            } else if (serviceName === 'gateway') {
                                // Update Gateway metrics
                                const versionElement = document.getElementById('gateway-version');
                                const uptimeElement = document.getElementById('gateway-uptime');
                                
                                if (versionElement) {
                                    versionElement.textContent = service.version || '-';
                                }
                                if (uptimeElement) {
                                    uptimeElement.textContent = service.uptime || '-';
                                }
                            }
                        } else {
                            // Service is offline, reset metrics to dashes
                            const metricElements = [
                                serviceName + '-models', serviceName + '-memory', serviceName + '-version',
                                serviceName + '-collections', serviceName + '-vectors', serviceName + '-keys',
                                serviceName + '-uptime'
                            ];
                            
                            metricElements.forEach(elementId => {
                                const element = document.getElementById(elementId);
                                if (element) {
                                    element.textContent = '-';
                                }
                            });
                        }
                    });
                } else {
                    console.error('Failed to check service status:', response.status);
                }
            } catch (error) {
                console.error('Error checking service status:', error);
            }
        }

        async function toggleService(serviceName, start) {
            try {
                const action = start ? 'start' : 'stop';
                const response = await fetch(`http://localhost:8081/admin/services/${serviceName}/${action}`, {
                    method: 'POST'
                });
                
                if (response.ok) {
                    console.log(`Service ${serviceName} ${action} command sent`);
                    // Refresh status after a short delay
                    setTimeout(() => {
                        checkServiceStatus();
                    }, 2000);
                } else {
                    console.error(`Failed to ${action} service ${serviceName}:`, response.status);
                }
            } catch (error) {
                console.error(`Error ${start ? 'starting' : 'stopping'} service ${serviceName}:`, error);
            }
        }
        
        async function restartService(serviceName) {
            try {
                // First stop the service
                await toggleService(serviceName, false);
                // Wait a bit, then start it
                setTimeout(async () => {
                    await toggleService(serviceName, true);
                }, 3000);
            } catch (error) {
                console.error(`Error restarting service ${serviceName}:`, error);
            }
        }
        
        function toggleServiceDetails(serviceName) {
            const detailsElement = document.getElementById(`${serviceName}-details`);
            const expandBtn = detailsElement.parentElement.querySelector('.expand-btn');
            
            if (detailsElement.classList.contains('expanded')) {
                detailsElement.classList.remove('expanded');
                expandBtn.textContent = 'View Details';
            } else {
                detailsElement.classList.add('expanded');
                expandBtn.textContent = 'Hide Details';
            }
        }

        async function refreshAllServices() {
            await checkServiceStatus();
            await checkModelStatus();
        }

        // Model Management Functions
        async function checkModelStatus() {
            try {
                const response = await fetch('http://localhost:8081/admin/models');
                if (response.ok) {
                    const data = await response.json();
                    const models = data.models || [];
                    
                    // Update homepage model displays dynamically
                    updateHomepageModels(models);
                } else {
                    console.error('Failed to check model status:', response.status);
                }
            } catch (error) {
                console.error('Error checking model status:', error);
            }
        }

        function updateHomepageModels(models) {
            // Update LLM models section
            const llmContainer = document.querySelector('#llm-models');
            if (llmContainer) {
                const llmModels = models.filter(m => m.type === 'llm');
                llmContainer.innerHTML = '';
                
                llmModels.forEach(model => {
                    const modelItem = document.createElement('div');
                    modelItem.className = 'model-item';
                    modelItem.innerHTML = `
                        <span class="model-name">${model.name}</span>
                        <span class="model-status ${model.running ? 'running' : model.available ? 'available' : 'unavailable'}">
                            ${model.running ? 'Running' : model.available ? 'Available' : 'Unavailable'}
                        </span>
                    `;
                    llmContainer.appendChild(modelItem);
                });
            }

            // Update embedding models section
            const embedContainer = document.querySelector('#embedding-models');
            if (embedContainer) {
                const embedModels = models.filter(m => m.type === 'embedding');
                embedContainer.innerHTML = '';
                
                embedModels.forEach(model => {
                    const modelItem = document.createElement('div');
                    modelItem.className = 'model-item';
                    modelItem.innerHTML = `
                        <span class="model-name">${model.name}</span>
                        <span class="model-status ${model.running ? 'running' : model.available ? 'available' : 'unavailable'}">
                            ${model.running ? 'Running' : model.available ? 'Available' : 'Unavailable'}
                        </span>
                    `;
                    embedContainer.appendChild(modelItem);
                });
            }
        }

        async function loadModelsData() {
            await checkModelStatus();
            await loadAdminModels();
        }

        async function loadDependenciesData() {
            await updateDependencyStatus();
        }

        async function loadSystemData() {
            await updateSystemMetrics();
            await loadCollections();
        }

        // Model Management Functions
        async function refreshModels() {
            await checkModelStatus();
            await loadAdminModels();
        }

        async function loadAllModels() {
            try {
                const response = await fetch('http://localhost:8081/admin/models/load-all', {
                    method: 'POST'
                });
                if (response.ok) {
                    console.log('All models load command sent');
                    setTimeout(() => {
                        refreshModels();
                    }, 3000);
                } else {
                    console.error('Failed to load all models:', response.status);
                }
            } catch (error) {
                console.error('Error loading all models:', error);
            }
        }

        async function loadAdminModels() {
            try {
                const response = await fetch('http://localhost:8081/admin/models');
                if (response.ok) {
                    const data = await response.json();
                    const models = data.models || [];
                    const summary = data.summary || {};
                    
                    console.log('Enhanced models from API:', models);
                    console.log('Model summary:', summary);
                    
                    const modelsGrid = document.getElementById('admin-models-grid');
                    modelsGrid.innerHTML = '';
                    
                    // Group models by type from catalog
                    const llmModels = models.filter(m => m.type === 'llm');
                    const embeddingModels = models.filter(m => m.type === 'embedding');
                    
                    console.log('LLM models:', llmModels);
                    console.log('Embedding models:', embeddingModels);
                    
                    // Create LLM category
                    if (llmModels.length > 0) {
                        const llmCategory = document.createElement('div');
                        llmCategory.className = 'model-category';
                        llmCategory.innerHTML = `
                            <h3>üß† Language Models (LLMs)</h3>
                            <div class="model-list"></div>
                        `;
                        const llmList = llmCategory.querySelector('.model-list');
                        
                        llmModels.forEach(model => {
                            const modelItem = document.createElement('div');
                            modelItem.className = 'model-item';
                            
                            let actionButtons = '';
                            if (model.running) {
                                actionButtons = `
                                    <button class="model-btn unload" onclick="unloadModel('${model.name}')">‚èπÔ∏è Unload</button>
                                    <button class="model-btn info" onclick="showModelInfo('${model.name}')">‚ÑπÔ∏è Info</button>
                                `;
                            } else if (model.available) {
                                actionButtons = `
                                    <button class="model-btn load" onclick="loadModel('${model.name}')">‚ñ∂Ô∏è Load</button>
                                    <button class="model-btn delete" onclick="deleteModel('${model.name}')">üóëÔ∏è Delete</button>
                                    <button class="model-btn info" onclick="showModelInfo('${model.name}')">‚ÑπÔ∏è Info</button>
                                `;
                            } else {
                                actionButtons = `
                                    <button class="model-btn pull" onclick="pullModel('${model.name}')">‚¨áÔ∏è Pull</button>
                                    <button class="model-btn info" onclick="showModelInfo('${model.name}')">‚ÑπÔ∏è Info</button>
                                `;
                            }
                            
                            // Build collapsible usage info
                            let usageInfo = '';
                            if (model.used_by && model.used_by.length > 0) {
                                const usageText = model.used_by.map(u => `${u.name} (${u.type})`).join(', ');
                                const uniqueId = `usage-${model.name.replace(/[^a-zA-Z0-9]/g, '')}`;
                                usageInfo = `
                                    <div class="model-usage">
                                        <button class="used-by-toggle" onclick="toggleUsedBy('${uniqueId}')">
                                            <span>Used by ${model.used_by.length} app${model.used_by.length > 1 ? 's' : ''}</span>
                                            <span id="${uniqueId}-arrow">‚ñº</span>
                                        </button>
                                        <div class="used-by-list hidden" id="${uniqueId}">
                                            ${usageText}
                                        </div>
                                    </div>
                                `;
                            }
                            
                            // Add default indicator
                            let defaultIndicator = '';
                            if (model.is_default_chat) {
                                defaultIndicator = '<span class="model-default">‚≠ê Default Chat</span>';
                            }
                            
                            modelItem.innerHTML = `
                                <div class="model-header">
                                    <span class="model-name">${model.name}${defaultIndicator}</span>
                                    <span class="model-status ${model.running ? 'running' : model.available ? 'available' : 'unavailable'}">
                                        ${model.running ? 'Running' : model.available ? 'Available' : 'Unavailable'}
                                    </span>
                                </div>
                                ${usageInfo}
                                <div class="model-actions">
                                    ${actionButtons}
                                </div>
                            `;
                            llmList.appendChild(modelItem);
                        });
                        
                        modelsGrid.appendChild(llmCategory);
                    }
                    
                    // Create Embedding category
                    if (embeddingModels.length > 0) {
                        const embedCategory = document.createElement('div');
                        embedCategory.className = 'model-category';
                        embedCategory.innerHTML = `
                            <h3>üî§ Embedding Models</h3>
                            <div class="model-list"></div>
                        `;
                        const embedList = embedCategory.querySelector('.model-list');
                        
                        embeddingModels.forEach(model => {
                            const modelItem = document.createElement('div');
                            modelItem.className = 'model-item';
                            
                            let actionButtons = '';
                            if (model.running) {
                                actionButtons = `
                                    <button class="model-btn unload" onclick="unloadModel('${model.name}')">‚èπÔ∏è Unload</button>
                                    <button class="model-btn info" onclick="showModelInfo('${model.name}')">‚ÑπÔ∏è Info</button>
                                `;
                            } else if (model.available) {
                                actionButtons = `
                                    <button class="model-btn load" onclick="loadModel('${model.name}')">‚ñ∂Ô∏è Load</button>
                                    <button class="model-btn delete" onclick="deleteModel('${model.name}')">üóëÔ∏è Delete</button>
                                    <button class="model-btn info" onclick="showModelInfo('${model.name}')">‚ÑπÔ∏è Info</button>
                                `;
                            } else {
                                actionButtons = `
                                    <button class="model-btn pull" onclick="pullModel('${model.name}')">‚¨áÔ∏è Pull</button>
                                    <button class="model-btn info" onclick="showModelInfo('${model.name}')">‚ÑπÔ∏è Info</button>
                                `;
                            }
                            
                            // Build collapsible usage info
                            let usageInfo = '';
                            if (model.used_by && model.used_by.length > 0) {
                                const usageText = model.used_by.map(u => `${u.name} (${u.type})`).join(', ');
                                const uniqueId = `usage-${model.name.replace(/[^a-zA-Z0-9]/g, '')}`;
                                usageInfo = `
                                    <div class="model-usage">
                                        <button class="used-by-toggle" onclick="toggleUsedBy('${uniqueId}')">
                                            <span>Used by ${model.used_by.length} app${model.used_by.length > 1 ? 's' : ''}</span>
                                            <span id="${uniqueId}-arrow">‚ñº</span>
                                        </button>
                                        <div class="used-by-list hidden" id="${uniqueId}">
                                            ${usageText}
                                        </div>
                                    </div>
                                `;
                            }
                            
                            // Add default indicator
                            let defaultIndicator = '';
                            if (model.is_default_embed) {
                                defaultIndicator = '<span class="model-default">‚≠ê Default Embedding</span>';
                            }
                            
                            modelItem.innerHTML = `
                                <div class="model-header">
                                    <span class="model-name">${model.name}${defaultIndicator}</span>
                                    <span class="model-status ${model.running ? 'running' : model.available ? 'available' : 'unavailable'}">
                                        ${model.running ? 'Running' : model.available ? 'Available' : 'Unavailable'}
                                    </span>
                                </div>
                                ${usageInfo}
                                <div class="model-actions">
                                    ${actionButtons}
                                </div>
                            `;
                            embedList.appendChild(modelItem);
                        });
                        
                        modelsGrid.appendChild(embedCategory);
                    }
                    
                    // If no embedding models found, show all models for debugging
                    if (embeddingModels.length === 0 && models.length > 0) {
                        const debugCategory = document.createElement('div');
                        debugCategory.className = 'model-category';
                        debugCategory.innerHTML = `
                            <h3>üîç All Available Models (Debug)</h3>
                            <div class="model-list"></div>
                        `;
                        const debugList = debugCategory.querySelector('.model-list');
                        
                        models.forEach(model => {
                            const modelItem = document.createElement('div');
                            modelItem.className = 'model-item';
                            modelItem.innerHTML = `
                                <span class="model-name">${model.name}</span>
                                <span class="model-status ${model.running ? 'running' : model.available ? 'available' : 'unavailable'}">
                                    ${model.running ? 'Running' : model.available ? 'Available' : 'Unavailable'}
                                </span>
                                <div class="model-actions">
                                    <button class="model-btn info" onclick="showModelInfo('${model.name}')">‚ÑπÔ∏è Info</button>
                                </div>
                            `;
                            debugList.appendChild(modelItem);
                        });
                        
                        modelsGrid.appendChild(debugCategory);
                    }
                } else {
                    console.error('Failed to load admin models:', response.status);
                }
            } catch (error) {
                console.error('Error loading admin models:', error);
            }
        }

        // Dependency Management Functions
        async function updateDependencyStatus() {
            try {
                const response = await fetch('http://localhost:8081/admin/services/status');
                if (response.ok) {
                    const services = await response.json();
                    
                    // Update dependency nodes
                    Object.keys(services).forEach(serviceName => {
                        const nodeElement = document.querySelector(`.service-node.${serviceName}`);
                        if (nodeElement) {
                            const statusElement = nodeElement.querySelector('.node-status');
                            const isOnline = services[serviceName].status === 'online';
                            statusElement.textContent = isOnline ? 'Online' : 'Offline';
                            statusElement.className = `node-status ${isOnline ? 'online' : 'offline'}`;
                        }
                    });
                } else {
                    console.error('Failed to update dependency status:', response.status);
                }
            } catch (error) {
                console.error('Error updating dependency status:', error);
            }
        }

        // Model Operations
        async function loadModel(modelName) {
            try {
                addModelLog('info', 'MODEL', `‚ñ∂Ô∏è Loading model: ${modelName}`);
                const response = await fetch(`http://localhost:8081/admin/models/${encodeURIComponent(modelName)}/load`, {
                    method: 'POST'
                });
                if (response.ok) {
                    addModelLog('info', 'MODEL', `Model ${modelName} loaded successfully`);
                    setTimeout(() => {
                        refreshModels();
                    }, 2000);
                        } else {
                    addModelLog('error', 'MODEL', `Failed to load model ${modelName}: ${response.status}`);
                        }
            } catch (error) {
                addModelLog('error', 'MODEL', `Error loading model ${modelName}: ${error.message}`);
            }
        }

        async function unloadModel(modelName) {
            try {
                addModelLog('info', 'MODEL', `‚èπÔ∏è Unloading model: ${modelName}`);
                const response = await fetch(`http://localhost:8081/admin/models/${encodeURIComponent(modelName)}/unload`, {
                    method: 'POST'
                });
                if (response.ok) {
                    addModelLog('info', 'MODEL', `Model ${modelName} unloaded successfully`);
                    setTimeout(() => {
                        refreshModels();
                    }, 2000);
                } else {
                    addModelLog('error', 'MODEL', `Failed to unload model ${modelName}: ${response.status}`);
                }
            } catch (error) {
                addModelLog('error', 'MODEL', `Error unloading model ${modelName}: ${error.message}`);
            }
        }

        async function deleteModel(modelName) {
            if (!confirm(`Are you sure you want to delete model "${modelName}"? This action cannot be undone.`)) {
                return;
            }
            
            try {
                addModelLog('info', 'MODEL', `Deleting model: ${modelName}`);
                const response = await fetch(`http://localhost:8081/admin/models/${encodeURIComponent(modelName)}`, {
                    method: 'DELETE'
                });
                if (response.ok) {
                    addModelLog('info', 'MODEL', `Model ${modelName} deleted successfully`);
                    setTimeout(() => {
                        refreshModels();
                    }, 2000);
                } else {
                    addModelLog('error', 'MODEL', `Failed to delete model ${modelName}: ${response.status}`);
                }
            } catch (error) {
                addModelLog('error', 'MODEL', `Error deleting model ${modelName}: ${error.message}`);
            }
        }

        async function showModelInfo(modelName) {
            try {
                addModelLog('info', 'MODEL', `Fetching info for model: ${modelName}`);
                
                // Get model details from Ollama
                const response = await fetch(`http://localhost:11434/api/show`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ name: modelName })
                });
                
                if (response.ok) {
                    const modelInfo = await response.json();
                    const infoText = `
Model: ${modelInfo.name}
Size: ${modelInfo.size ? (modelInfo.size / 1024 / 1024 / 1024).toFixed(2) + ' GB' : 'Unknown'}
Format: ${modelInfo.format || 'Unknown'}
Family: ${modelInfo.family || 'Unknown'}
Parameters: ${modelInfo.parameter_size || 'Unknown'}
Quantization: ${modelInfo.quantization_level || 'Unknown'}
                    `.trim();
                    
                    addModelLog('info', 'MODEL', `Model info for ${modelName}: ${infoText}`);
                    alert(`Model Information:\n\n${infoText}`);
                        } else {
                    addModelLog('warning', 'MODEL', `Could not fetch detailed info for ${modelName}`);
                    alert(`Model: ${modelName}\nStatus: Available\n\nDetailed information not available.`);
                    }
                } catch (error) {
                addModelLog('error', 'MODEL', `Error fetching model info for ${modelName}: ${error.message}`);
            }
        }

        // Log Management
        let logStreaming = false;
        let logInterval = null;

        function addModelLog(level, service, message) {
            const logsContainer = document.getElementById('model-logs');
            const timestamp = new Date().toLocaleTimeString();
            
            const logEntry = document.createElement('div');
            logEntry.className = 'log-entry';
            logEntry.innerHTML = `
                <span class="log-timestamp">[${timestamp}]</span>
                <span class="log-level ${level}">${level.toUpperCase()}</span>
                <span class="log-service">${service}</span>
                <span class="log-message">${message}</span>
            `;
            
            logsContainer.insertBefore(logEntry, logsContainer.firstChild);
            
            // Keep only last 50 log entries
            while (logsContainer.children.length > 50) {
                logsContainer.removeChild(logsContainer.lastChild);
            }
        }

        function clearModelLogs() {
            const logsContainer = document.getElementById('model-logs');
            logsContainer.innerHTML = `
                <div class="log-entry">
                    <span class="log-timestamp">[${new Date().toLocaleTimeString()}]</span>
                    <span class="log-level info">INFO</span>
                    <span class="log-service">SYSTEM</span>
                    <span class="log-message">Logs cleared</span>
                </div>
            `;
        }

        function toggleUsedBy(uniqueId) {
            const listElement = document.getElementById(uniqueId);
            const arrowElement = document.getElementById(uniqueId + '-arrow');
            
            if (listElement.classList.contains('hidden')) {
                listElement.classList.remove('hidden');
                arrowElement.textContent = '‚ñ≤';
            } else {
                listElement.classList.add('hidden');
                arrowElement.textContent = '‚ñº';
            }
        }

        function refreshModelLogs() {
            addModelLog('info', 'SYSTEM', 'Refreshing model logs...');
        }

        function toggleLogStreaming() {
            logStreaming = !logStreaming;
            if (logStreaming) {
                addModelLog('info', 'SYSTEM', 'Live log streaming enabled');
                logInterval = setInterval(() => {
                    // Simulate live logs
                    const randomMessages = [
                        'Model status check completed',
                        'Memory usage: 2.1GB',
                        'Request processed successfully',
                        'Cache hit rate: 85%',
                        'Model inference time: 1.2s'
                    ];
                    const randomMessage = randomMessages[Math.floor(Math.random() * randomMessages.length)];
                    addModelLog('debug', 'SYSTEM', randomMessage);
                }, 5000);
                } else {
                addModelLog('info', 'SYSTEM', 'Live log streaming disabled');
                if (logInterval) {
                    clearInterval(logInterval);
                    logInterval = null;
                }
            }
        }

        // Service Logs Functions
        async function loadServiceLogs() {
            const serviceName = document.getElementById('service-log-selector').value;
            try {
                const response = await fetch(`http://localhost:8081/admin/logs/${serviceName}?lines=50`);
                if (response.ok) {
                    const logs = await response.json();
                    updateServiceLogs(logs);
                } else {
                    console.error('Failed to load service logs:', response.status);
                }
            } catch (error) {
                console.error('Error loading service logs:', error);
            }
        }

        function updateServiceLogs(logs) {
            const logsContainer = document.getElementById('service-logs');
            logsContainer.innerHTML = '';
            
            if (logs && logs.length > 0) {
                logs.forEach(log => {
                        const logEntry = document.createElement('div');
                        logEntry.className = 'log-entry';
                    
                    const timestamp = new Date().toLocaleTimeString();
                    const level = log.level || 'info';
                    const service = log.service || 'UNKNOWN';
                    const message = log.message || log;
                    
                        logEntry.innerHTML = `
                        <span class="log-timestamp">[${timestamp}]</span>
                        <span class="log-level ${level}">${level.toUpperCase()}</span>
                            <span class="log-service">${service}</span>
                        <span class="log-message">${message}</span>
                        `;
                    
                    logsContainer.appendChild(logEntry);
                });
                } else {
                logsContainer.innerHTML = `
                    <div class="log-entry">
                        <span class="log-timestamp">[${new Date().toLocaleTimeString()}]</span>
                        <span class="log-level info">INFO</span>
                        <span class="log-service">SYSTEM</span>
                        <span class="log-message">No logs available for this service</span>
                    </div>
                `;
            }
        }

        function refreshServiceLogs() {
            loadServiceLogs();
        }

        function clearServiceLogs() {
            const logsContainer = document.getElementById('service-logs');
            logsContainer.innerHTML = `
                <div class="log-entry">
                    <span class="log-timestamp">[${new Date().toLocaleTimeString()}]</span>
                    <span class="log-level info">INFO</span>
                    <span class="log-service">SYSTEM</span>
                    <span class="log-message">Service logs cleared</span>
                </div>
            `;
        }

        function updateServiceOperations(operations) {
            const operationsContainer = document.getElementById('service-operations');
            operationsContainer.innerHTML = '';
            
            operations.forEach(op => {
                const operationItem = document.createElement('div');
                operationItem.className = `operation-item ${op.status}`;
                operationItem.innerHTML = `
                    <div class="operation-details">
                        <div class="operation-service">${op.service}</div>
                        <div class="operation-action">${op.action}</div>
                        <div class="operation-timestamp">${op.timestamp}</div>
                    </div>
                    <span class="operation-status ${op.status}">${op.status}</span>
                `;
                operationsContainer.appendChild(operationItem);
            });
        }

        // System Monitoring Functions
        async function updateSystemMetrics() {
            try {
                const response = await fetch('http://localhost:8081/admin/system/metrics');
                if (response.ok) {
                    const metrics = await response.json();
                    
                    // Update system resource displays
                    const cpuElement = document.getElementById('cpu-usage');
                    const memoryElement = document.getElementById('memory-usage');
                    const diskElement = document.getElementById('disk-usage');
                    const connectionsElement = document.getElementById('active-connections');
                    const requestsElement = document.getElementById('requests-per-minute');
                    
                    if (cpuElement) cpuElement.textContent = metrics.cpu || 'N/A';
                    if (memoryElement) memoryElement.textContent = metrics.memory || 'N/A';
                    if (diskElement) diskElement.textContent = metrics.disk || 'N/A';
                    if (connectionsElement) connectionsElement.textContent = metrics.connections || 'N/A';
                    if (requestsElement) requestsElement.textContent = metrics.requests_per_minute || 'N/A';
                } else {
                    console.error('Failed to update system metrics:', response.status);
                }
            } catch (error) {
                console.error('Error updating system metrics:', error);
            }
        }

        // Collection Management Functions
        async function loadCollections() {
            try {
                const response = await fetch('http://localhost:6333/collections');
                if (response.ok) {
                    const data = await response.json();
                    const collections = data.result?.collections || [];
                    updateCollectionsList(collections);
                } else {
                    console.error('Failed to load collections:', response.status);
                }
            } catch (error) {
                console.error('Error loading collections:', error);
            }
        }

        function updateCollectionsList(collections) {
            const collectionsList = document.getElementById('collections-list');
            collectionsList.innerHTML = '';
            
            if (collections.length > 0) {
                collections.forEach(collection => {
                    const collectionItem = document.createElement('div');
                    collectionItem.className = 'resource-item';
                    collectionItem.innerHTML = `
                        <span class="resource-label">${collection.name}</span>
                        <span class="resource-value">
                            ${collection.vectors_count || 0} vectors
                            <button class="model-btn delete" onclick="deleteCollection('${collection.name}')" style="margin-left: 10px;">üóëÔ∏è Delete</button>
                        </span>
                    `;
                    collectionsList.appendChild(collectionItem);
                });
                } else {
                collectionsList.innerHTML = `
                    <div class="resource-item">
                        <span class="resource-label">No collections found</span>
                        <span class="resource-value">-</span>
                    </div>
                `;
            }
        }

        async function refreshCollections() {
            await loadCollections();
        }

        async function deleteCollection(collectionName) {
            if (!confirm(`Are you sure you want to delete collection "${collectionName}"? This action cannot be undone.`)) {
                return;
            }
            
            try {
                const response = await fetch(`http://localhost:8081/admin/collections/${collectionName}`, {
                    method: 'DELETE'
                });
                if (response.ok) {
                    console.log(`Collection ${collectionName} deleted successfully`);
                    await loadCollections();
                } else {
                    console.error(`Failed to delete collection ${collectionName}:`, response.status);
                }
            } catch (error) {
                console.error(`Error deleting collection ${collectionName}:`, error);
            }
        }

        function showCreateCollection() {
            const collectionName = prompt('Enter collection name:');
            if (collectionName) {
                createCollection(collectionName);
            }
        }

        async function createCollection(collectionName) {
            try {
                const response = await fetch('http://localhost:6333/collections', {
                    method: 'PUT',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        name: collectionName,
                        vectors: {
                            size: 384,
                            distance: 'Cosine'
                        }
                    })
                });
                if (response.ok) {
                    console.log(`Collection ${collectionName} created successfully`);
                    await loadCollections();
                } else {
                    console.error(`Failed to create collection ${collectionName}:`, response.status);
                }
            } catch (error) {
                console.error(`Error creating collection ${collectionName}:`, error);
            }
        }

        // Initialize on page load
        document.addEventListener('DOMContent‚ñ∂Ô∏è Loaded', function() {
            console.log('ABS AI Hub loaded successfully');
            // ‚ñ∂Ô∏è Load initial data
            refreshAllServices();
            loadAppsData(); // ‚ñ∂Ô∏è Load apps data on page load
        });
    </script>
</body>
</html>
